"use strict";const animeInput=document.querySelector(".js-input"),submitBtn=document.querySelector(".js-submit"),resetBtn=document.querySelector(".js-reset"),favList=document.querySelector(".js-favourites"),resultList=document.querySelector(".js-results");let resultElements=[],favElements=[];function checkInput(){0==animeInput.value.length?animeInput.classList.add("empty"):animeInput.classList.remove("empty")}function getAnime(e){e.preventDefault(),checkInput(),fetch("https://api.jikan.moe/v3/search/anime?q="+animeInput.value).then(e=>e.json()).then(e=>{resultElements=e.results,renderResultList(resultElements)})}function renderResultList(e){resultList.innerHTML="";for(let t=0;t<e.length;t++){const s=document.createElement("li"),a=document.createElement("img"),n=document.createElement("h3"),r=document.createTextNode(e[t].title);s.appendChild(a),s.appendChild(n),s.classList.add("results__card","js-card"),a.alt=e[t].title,a.classList.add("results__card--img"),n.appendChild(r),n.classList.add("results__card--title","js-cardTitle"),resultList.appendChild(s),"https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620"===e[t].image_url||""===e[t].image_url?a.src="https://via.placeholder.com/210x295/bbe1fa/0f4c75/?text="+e[t].title:a.src=e[t].image_url;const i=document.querySelectorAll(".js-card");for(const e of i)e.addEventListener("click",addFavourite);compareLists()}}function addFavourite(e){const t=e.currentTarget.querySelector(".results__card--img");if(e.currentTarget.classList.contains("favourite")){let s=favElements.findIndex(e=>e.title===t.alt);favElements.splice(s,1),e.currentTarget.classList.remove("favourite")}else{const s={title:t.alt,image_url:t.src};favElements.push(s),e.currentTarget.classList.add("favourite")}renderFavList(favElements)}function renderFavList(e){favList.innerHTML="";for(let t=0;t<e.length;t++){const s=document.createElement("li"),a=document.createElement("i"),n=document.createElement("img"),r=document.createElement("h3"),i=document.createTextNode(e[t].title);s.appendChild(a),s.appendChild(n),s.appendChild(r),s.classList.add("favourites__card","js-fav"),a.classList.add("fas","fa-times","favourites__card--icon","js-remove"),n.alt=e[t].title,n.classList.add("favourites__card--img"),r.appendChild(i),r.classList.add("favourites__card--title"),favList.appendChild(s),"https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620"===e[t].image_url||""===e[t].image_url?n.src="https://via.placeholder.com/210x295/bbe1fa/0f4c75/?text="+e[t].title:n.src=e[t].image_url;const l=document.querySelectorAll(".js-remove");for(const e of l)e.addEventListener("click",removeFavourite)}localStorage.setItem("favs",JSON.stringify(e))}function removeFavourite(e){const t=e.currentTarget.parentElement.querySelector(".favourites__card--img").alt;let s=favElements.findIndex(e=>e.title===t);favElements.splice(s,1),e.currentTarget.classList.remove("favourite"),renderFavList(favElements),compareLists()}function compareLists(){const e=document.querySelectorAll(".js-cardTitle");for(const t of e)favElements.some(e=>e.title===t.innerHTML)?t.parentElement.classList.add("favourite"):t.parentElement.classList.remove("favourite")}function resetFavs(e){e.preventDefault(),favElements=[],renderFavList(favElements),compareLists()}submitBtn.addEventListener("click",getAnime),animeInput.addEventListener("keyup",checkInput),resetBtn.addEventListener("click",resetFavs),0!==favElements.length&&(favElements=JSON.parse(localStorage.getItem("favs")),window.onload=renderFavList(favElements));